(()=>{const t=document.getElementById("main-graph"),e=document.getElementById("map-graph"),n=t.getContext("2d"),i=e.getContext("2d"),o=500,d=250,s=document.getElementById("map-wrapper"),l=document.getElementById("start-slider"),r=document.getElementById("center-slider"),h=document.getElementById("end-slider"),g=Math.round(2.5),a=.15,f=[],m={width:0,height:0,minHeight:null},u={start:{position:null,index:null},end:{position:null,index:null}},c={width:0,height:0,minHeight:0,maxHeight:0};let p=0,x=!0,y=null;function H(t){return m.width/o*t}function w(t,e,n,i){const d=[];return d.push((t[0]-e)/n.width*o),d.push(i-2.5-(t[1]-n.minHeight)/n.height*(1-2.5/n.height)*i),d}function E(){const{start:t,end:e}=u;!function(){const{start:t,end:e}=u;let n=0,i=f[n][0];for(;n<f.length;n++){if(i=f[n][0],i===t.position){t.index=n;break}if(i>t.position){t.index=n-1;break}}for(;n<f.length;n++)if(i=f[n][0],i>=e.position){e.index=n;break}}(),function(t,e){c.minHeight=f[t][1],c.maxHeight=f[t][1];for(let n=t+1;n<=e;n++){const t=f[n][1];t>c.maxHeight&&(c.maxHeight=t),t<c.minHeight&&(c.minHeight=t)}}(t.index,e.index),c.width=e.position-t.position,c.height=c.maxHeight-c.minHeight,n.clearRect(0,0,o,d),n.beginPath(),n.strokeStyle="#88ed2a",n.lineWidth=5,n.moveTo(...w(f[t.index],t.position,c,d));for(let i=t.index+1;i<=e.index;i++)n.lineTo(...w(f[i],t.position,c,d));n.stroke()}function I(t){"start-slider"!==t.target.id&&"end-slider"!==t.target.id&&"center-slider"!==t.target.id||(y=t.target,x=!1,L(t),v())}function k(){y=null,x=!0}function L(t){if(x)return;const n=parseInt(l.style.left),i=parseInt(h.style.left);p=t.clientX-s.offsetLeft,"start-slider"===y.id&&p>i?p=i:"end-slider"===y.id&&p<n?p=n:p<=e.offsetLeft?p=-g:p>e.offsetLeft+e.width&&(p=e.offsetLeft+e.width+g)}function v(){if(x)return;const t=parseInt(l.style.left),e=parseInt(h.style.left);let n=t,i=e;const d=(e-t)/2;"start-slider"===y.id?n+=(p-t)*a:"end-slider"===y.id?i+=(p-e)*a:p-d<0?(n+=(-g-t)*a,i+=(2*d-g-e)*a):p+d>o?(n+=(g+o-2*d-t)*a,i+=(g+o-e)*a):(n+=(p-d-t)*a,i+=(p+d-e)*a),n=Math.round(n),i=Math.round(i),l.style.left=`${n}px`,h.style.left=`${i}px`,r.style.left=l.style.left,r.style.right=o-i+"px",u.start.position=H(n),u.end.position=H(i),E(),requestAnimationFrame(v)}!function(t,e,n){console.time("generate");for(let t=0;t<=100;t++)f.push([t,(0,1500,Math.floor(1501*Math.random()+0))]);console.timeEnd("generate")}(),function(){const{start:n,end:i}=u;n.position=f[0][0],n.index=0,i.position=f[f.length-1][0],i.index=f.length-1,t.width=o,t.height=d,e.width=o,e.height=100,m.height=0,m.minHeight=f[0][1],m.width=f[f.length-1][0]-f[0][0];for(const t of f)t[1]>m.height&&(m.height=t[1]),t[1]<m.minHeight&&(m.minHeight=t[1]);l.style.width="5px",l.style.left="0px",h.style.width="5px",h.style.left="500px",r.style.left="0px",r.style.right="0px",document.addEventListener("mousedown",I),document.addEventListener("mousemove",L),document.addEventListener("mouseup",k)}(),function(){i.beginPath(),i.strokeStyle="#88ed2a",i.lineWidth=1,i.moveTo(...w(f[0],0,m,100));for(let t=1;t<f.length;t++)i.lineTo(...w(f[t],0,m,100));i.stroke()}(),E()})();