(()=>{"use strict";class e{constructor(e,t,i,s){this._startX=e,this._startY=t,this._endX=i,this._endY=s,this._width=this._endX-this._startX,this._height=this._endY-this._startY}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get width(){return this._width}get height(){return this._height}isCircleIn(e){return e.y>=this._startY&&e.y<=this._endY&&e.x>=this._startX&&e.x<=this._endX}static GenerateFromCanvas(t){return new e(0,0,t.getBoundingClientRect().width,t.getBoundingClientRect().height)}}class t{constructor(e,t,i){this._ctx=e,this._boundaries=t,this._scene=i}resetBoundaries(e){this._boundaries=e}draw(){this._ctx.clearRect(0,0,this._boundaries.width,this._boundaries.height),this._ctx.lineWidth=2;for(let e=0;e<this._scene.activeLineLastIndex;e++)this._ctx.beginPath(),this._ctx.strokeStyle=this._scene.poolLine[e].rgba.stringValue,this._ctx.moveTo(this._scene.poolLine[e].startX,this._scene.poolLine[e].startY),this._ctx.lineTo(this._scene.poolLine[e].endX,this._scene.poolLine[e].endY),this._ctx.stroke();this._ctx.fillStyle=this._scene.poolCircle[0].rgba.stringValue;const e=2*Math.PI;for(const t of this._scene.poolCircle)this._ctx.beginPath(),this._ctx.arc(t.x,t.y,t.radius,0,e),this._ctx.fill()}}class i{constructor(e,t,i,s){this._r=e,this._g=t,this._b=i,this._a=s,this._createStringValue()}get r(){return this._r}set r(e){this._r=e,this._createStringValue()}get g(){return this._g}set g(e){this._g=e,this._createStringValue()}get b(){return this._b}set b(e){this._b=e,this._createStringValue()}get a(){return this._a}set a(e){this._a=e,this._createStringValue()}get stringValue(){return this._stringValue}_createStringValue(){this._stringValue=`rgba(${this._r}, ${this._g}, ${this._b}, ${this._a})`}copy(){return new i(this._r,this._g,this._b,this._a)}static CreateDefault(){return new i(0,0,0,1)}}class s{constructor(e,t,i,s,r,n){this._x=e,this._y=t,this._radius=i,this._speedX=s,this._speedY=r,this._rgba=n}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get radius(){return this._radius}set radius(e){this._radius=e}get speedX(){return this._speedX}set speedX(e){this._speedX=e}get speedY(){return this._speedY}set speedY(e){this._speedY=e}get rgba(){return this._rgba}set rgba(e){this._rgba=e}copy(){return new s(this._x,this._y,this._radius,this._speedX,this._speedY,this._rgba.copy())}static CreateDefault(){return new s(0,0,0,0,0,new i(0,0,0,0))}}class r{constructor(e,t,i,s,r){this._startX=e,this._startY=t,this._endX=i,this._endY=s,this._rgba=r}get startX(){return this._startX}set startX(e){this._startX=e}get startY(){return this._startY}set startY(e){this._startY=e}get endX(){return this._endX}set endX(e){this._endX=e}get endY(){return this._endY}set endY(e){this._endY=e}get rgba(){return this._rgba}set rgba(e){this._rgba=e}resetPositions(e,t,i,s){return this._startX=e,this._startY=t,this._endX=i,this._endY=s,this}copy(){return new r(this._startX,this._startY,this._endX,this._endY,this._rgba.copy())}static CreateDefault(){return new r(0,0,0,0,new i(0,0,0,0))}}class n{constructor(e,t){this._poolCircle=e,this._poolLine=[],this._activeLineLastIndex=0;for(let i=0;i<e.length*e.length;i++)this._poolLine.push(t.copy())}get poolCircle(){return this._poolCircle}get poolLine(){return this._poolLine}get activeLineLastIndex(){return this._activeLineLastIndex}addLine(e,t,i,s,r){const n=this._poolLine[this._activeLineLastIndex];n.resetPositions(e,t,i,s),n.rgba.a=r,this._activeLineLastIndex=this._activeLineLastIndex+1}clearPoolLine(){this._activeLineLastIndex=0}static Generate(e,t,i,h){const c=[],a=(e,t)=>Math.random()*(t-e+1)+e,_=()=>-2*Math.round(Math.random())+1;for(let r=0;r<e;r++)c.push(new s(a(t.startX,t.endX),a(t.startY,t.endY),4,a(.1,.5)*_(),a(.1,.5)*_(),i.copy()));return new n(c,new r(0,0,0,0,h))}}class h{get grid(){return this._grid}clear(){for(let e=0;e<this._grid.length;e++)for(let t=0;t<this._grid[e].length;t++)this._grid[e][t]=[]}_generateGrid(e,t){const i=[],s=Math.ceil(e.endY/t),r=Math.ceil(e.endX/t);for(let e=0;e<s;e++){i.push([]);for(let t=0;t<r;t++)i[e].push([])}return i}init(e,t){this._cellSize=t,this._grid=this._generateGrid(e,t)}resetBoundaries(e){this._grid=this._generateGrid(e,this._cellSize)}_isCircleInCell(e,t,i){const s=i*this._cellSize,r=t*this._cellSize,n=s+this._cellSize,h=r+this._cellSize;return e.x>=s&&e.x<=n&&e.y>=r&&e.y<=h}addCircle(e){for(let t=0;t<this._grid.length;t++)for(let i=0;i<this._grid[t].length;i++)if(this._isCircleInCell(e,t,i))return void this._grid[t][i].push(e)}}class c{constructor(e,t,i){this._boundaries=e,this._scene=t,this._lineMaxLength=i,this._sceneGrid=new h,this._sceneGrid.init(e,i)}_createCirclePair(e,t,i){const s=e.x-t.x,r=e.y-t.y,n=s*s+r*r;n<=this._lineMaxLength*this._lineMaxLength&&this._scene.addLine(e.x,e.y,t.x,t.y,1-i*n)}_createLineBetweenCirclesInCell(e,t,i=0){const s=1/(this._lineMaxLength*this._lineMaxLength);for(let r=i;r<t.length;r++)this._createCirclePair(e,t[r],s)}_createLineBetweenCirclesInsideCell(e){const t=1/(this._lineMaxLength*this._lineMaxLength);for(let i=0;i<e.length;i++){const s=e[i];for(let r=i+1;r<e.length;r++){const i=e[r];this._createCirclePair(s,i,t)}}}_createCirclePairsInGridPart(e,t,i,s,r){for(let n=e;n<t;n++)for(let e=i;e<s;e++){const t=this._sceneGrid.grid[n][e];this._createLineBetweenCirclesInsideCell(t);for(const i of t)r(i,n,e)}}_createCirclePairsInGrid(){const e=this._sceneGrid.grid.length-1,t=this._sceneGrid.grid[e].length-1;this._createCirclePairsInGridPart(0,e,1,t,((e,t,i)=>{this._createLineBetweenCirclesInCell(e,this._sceneGrid.grid[t][i+1]),this._createLineBetweenCirclesInCell(e,this._sceneGrid.grid[t+1][i+1]),this._createLineBetweenCirclesInCell(e,this._sceneGrid.grid[t+1][i]),this._createLineBetweenCirclesInCell(e,this._sceneGrid.grid[t+1][i-1])})),this._createCirclePairsInGridPart(0,e,t,t+1,((e,t,i)=>{this._createLineBetweenCirclesInCell(e,this._sceneGrid.grid[t+1][i]),this._createLineBetweenCirclesInCell(e,this._sceneGrid.grid[t+1][i-1])})),this._createCirclePairsInGridPart(e,e+1,0,t,((e,t,i)=>{this._createLineBetweenCirclesInCell(e,this._sceneGrid.grid[t][i+1])})),this._createCirclePairsInGridPart(0,e,0,1,((e,t,i)=>{this._createLineBetweenCirclesInCell(e,this._sceneGrid.grid[t][i+1]),this._createLineBetweenCirclesInCell(e,this._sceneGrid.grid[t+1][i+1]),this._createLineBetweenCirclesInCell(e,this._sceneGrid.grid[t+1][i])})),this._createLineBetweenCirclesInsideCell(this._sceneGrid.grid[e][t])}resetBoundaries(e){this._boundaries=e,this._sceneGrid.resetBoundaries(e)}resetLineMaxLength(e){this._lineMaxLength=e}update(){this._scene.clearPoolLine(),this._sceneGrid.clear();for(const e of this._scene.poolCircle)e.x=(this._boundaries.endX+e.x+e.speedX)%this._boundaries.endX,e.y=(this._boundaries.endY+e.y+e.speedY)%this._boundaries.endY,this._sceneGrid.addCircle(e);this._createCirclePairsInGrid()}}const a=document.querySelector("canvas");if(null==a)throw new Error("can't get canvas");const _=a.getContext("2d");if(null==_)throw new Error("can't get canvas context");a.width=window.innerWidth,a.height=window.innerHeight;const l=new class{constructor(e,t,i){this._canvas=e,this._ctx=t,this._isPaused=!0,this._config=void 0!==i?this._generateAppConfig(i):this._generateAppConfig({})}_generateAppConfig(e){var t,s;const r=null!==(t=e.circleCount)&&void 0!==t?t:100,n=null!==(s=e.circleConnectionMaxDistance)&&void 0!==s?s:200;let h,c;if(void 0===e.circleColor)h=i.CreateDefault();else{const{r:t,g:s,b:r}=e.circleColor;h=new i(t,s,r,1)}if(void 0===e.circleConnectionColor)c=i.CreateDefault();else{const{r:t,g:s,b:r}=e.circleConnectionColor;c=new i(t,s,r,1)}return{circleCount:r,circleColor:h,circleConnectionMaxDistance:n,circleConnectionColor:c}}resize(){this._sceneUpdateSystem.resetBoundaries(e.GenerateFromCanvas(this._canvas)),this._renderer.resetBoundaries(e.GenerateFromCanvas(this._canvas)),this._renderer.draw()}init(){const{circleCount:i,circleColor:s,circleConnectionMaxDistance:r,circleConnectionColor:h}=this._config,a=e.GenerateFromCanvas(this._canvas),_=n.Generate(i,a,s,h);this._sceneUpdateSystem=new c(a,_,r),this._renderer=new t(this._ctx,a,_)}run(){this._isPaused=!1;const e=()=>{this._isPaused||(this._sceneUpdateSystem.update(),this._renderer.draw(),requestAnimationFrame(e))};e()}pause(){this._isPaused=!0}}(a,_,{circleCount:75,circleColor:{r:247,g:129,b:102},circleConnectionMaxDistance:200,circleConnectionColor:{r:181,g:132,b:121}});let o=!0;window.onclick=()=>{o?(o=!1,l.run()):(o=!0,l.pause())},window.onresize=()=>{a.width=window.innerWidth,a.height=window.innerHeight,l.resize()},l.init(),l.run(),o=!1})();